# Gitea-to-Git-Migration
Scripts for batch migrating Gitea repos to GitHub and granting **Read** access to a team account, or download Gitea repos to your local drive.

## Scripting Requirements
Software:
- Windows PowerShell
- Git Bash
- GitHub CLI (gh): `winget install --id GitHub.cli`

You must have **Write** access to your local drive, and the local drive has sufficient free space to hold the downloaded repo(s), and log file generated by the script.

## Preparation

### Set the policy to enable PS Scripts
`PS C:\> Set-ExecutionPolicy RemoteSigned -Scope CurrentUser`

### To be authenticated to GitHub and Gitea before using the batch processing scripts
You needs to be authenticated only once.

#### Log in to GitHub.com through PowerShell

```
PS C:\> gh auth login
? What account do you want to log into?  [Use arrows to move, type to filter]
> GitHub.com
  GitHub Enterprise Server
  ...
```

#### Authenticated by Gitea through PowerShell

Use your Gitea user ID and the token generated from your Gitea as the password for authentication.
`PS C:\>git clone --mirror https://your.gitea.com/(org)/(repo).git`

### Sample_Gitea_repo_list.csv
[Sample_Gitea_repo_list.csv](https://github.com/bcgov/operational-utilities/blob/main/gitea-to-github-migration/Sample_Gitea_repo_list.csv) is a sample Gitea repo list file to demo the format and content of a comma separated list file that our migration scripts can read.

## Usage

### Gitea2GitHub.ps1
**Purpose:** Batch migrating Gitea repos to github based on the list in a CSV file.

**Usage:**

`.\Gitea2GitHub.ps1 -GiteaWebsite [https://your.gitea.com] -GiteaUser [Your user ID] -GiteaToken [Your Gitea token] -GiteaRepoList [GiteaRepoList.csv] -RepoSuffix [Optional github repo suffix] -Mirror [Optional $true or $false]`
- GiteaRepoList.csv is a comma separated value file with five tuples per row: <br>*Gitea_Org, Gitea_Repo, GitHub_Org, GitHub_Repo, (Optional)GitHub_ServiceAccount*
- Use '#' to comment out lines in GiteaRepoList.csv
- If GitHub_ServiceAccount is provided, the script will grant Read access to the account.
- If the Optional github repo suffix is provided, the new GitHub repo will be:  GitHub_Repo-RepoSuffix
- If Readme.md is missing from a repo, the script will create one based on the gitea repo description.

### Gitea2Local.ps1
**Purpose:** Batch download Gitea repos to your workstation based on the list in a CSV file.

**Usage:**

`.\Gitea2Local.ps1 -GiteaWebsite [https://your.gitea.com] -GiteaUser [Your user ID] -GiteaToken [Your Gitea token] -GiteaRepoList [GiteaRepoList.csv]`
GiteaRepoList.csv is a comma separated value file with two tuples per row: 
<br>&nbsp;&nbsp;&nbsp;*gitea_org, gitea_repo*<br>
If the file has more than two tuples, the rest tuples are ignored.
